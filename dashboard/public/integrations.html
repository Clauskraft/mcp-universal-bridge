<!DOCTYPE html>
<html lang="da">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Integrations - MCP Universal AI Bridge</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; background: #f5f5f5; }

        :root {
            --tdc-blue: #0000FF;
            --tdc-dark-blue: #00008B;
            --tdc-light-blue: #ADD8E6;
            --text-primary: #1a1a1a;
            --text-secondary: #666;
            --border: #e0e0e0;
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
        }

        .header {
            background: linear-gradient(135deg, var(--tdc-blue) 0%, var(--tdc-dark-blue) 100%);
            color: white;
            padding: 2rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .header h1 { font-size: 2rem; font-weight: 700; margin-bottom: 0.5rem; }
        .header p { opacity: 0.9; font-size: 1.1rem; }

        .nav {
            background: white;
            border-bottom: 1px solid var(--border);
            padding: 1rem 2rem;
        }

        .nav a {
            text-decoration: none;
            color: var(--text-secondary);
            padding: 0.5rem 1rem;
            margin-right: 1rem;
            border-radius: 6px;
            transition: all 0.2s;
        }

        .nav a:hover { background: #f0f0f0; color: var(--text-primary); }
        .nav a.active { background: var(--tdc-blue); color: white; }

        .container { max-width: 1400px; margin: 0 auto; padding: 2rem; }

        .capabilities-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 3rem;
        }

        .capability-card {
            background: white;
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            border: 2px solid var(--border);
            transition: all 0.2s;
        }

        .capability-card:hover {
            border-color: var(--tdc-blue);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,255,0.15);
        }

        .capability-card.connected {
            border-color: var(--success);
            background: #f0fdf4;
        }

        .capability-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .capability-icon {
            font-size: 2.5rem;
        }

        .capability-status {
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .capability-status.connected {
            background: #d1fae5;
            color: #065f46;
        }

        .capability-status.available {
            background: #e0e0e0;
            color: #666;
        }

        .capability-card h3 {
            font-size: 1.25rem;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }

        .capability-card p {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-bottom: 1rem;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.9rem;
        }

        .btn-primary {
            background: var(--tdc-blue);
            color: white;
        }

        .btn-primary:hover {
            background: var(--tdc-dark-blue);
            transform: translateY(-2px);
        }

        .btn-danger {
            background: var(--error);
            color: white;
        }

        .btn-danger:hover {
            background: #dc2626;
        }

        .card {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            margin-bottom: 1.5rem;
        }

        .card h2 {
            font-size: 1.5rem;
            color: var(--text-primary);
            margin-bottom: 1.5rem;
            border-bottom: 2px solid var(--tdc-blue);
            padding-bottom: 0.5rem;
        }

        .integration-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            background: #f9fafb;
            border-radius: 8px;
            margin-bottom: 0.75rem;
            border: 1px solid var(--border);
        }

        .integration-info {
            flex: 1;
        }

        .integration-name {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.25rem;
        }

        .integration-meta {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        .integration-actions {
            display: flex;
            gap: 0.5rem;
        }

        .badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            margin-left: 0.5rem;
        }

        .badge.enabled { background: #d1fae5; color: #065f46; }
        .badge.disabled { background: #fee2e2; color: #991b1b; }
    </style>
</head>
<body>
    <div class="header">
        <h1>üîå Integrations</h1>
        <p>Connect to Gmail, Google Calendar, Maps, and more</p>
    </div>

    <div class="nav">
        <a href="/dashboard">üìä Dashboard</a>
        <a href="/dashboard/chat.html">üí¨ Chat</a>
        <a href="/dashboard/settings.html">‚öôÔ∏è Settings</a>
        <a href="/dashboard/integrations.html" class="active">üîå Integrations</a>
        <a href="/dashboard/mini-tools.html">üõ†Ô∏è Mini Tools</a>
        <a href="/test-deployment">üß™ Test</a>
    </div>

    <div class="container">
        <!-- Available Capabilities -->
        <h2 style="margin-bottom: 1.5rem;">üì± Available Integrations</h2>
        <div class="capabilities-grid" id="capabilities-grid">
            <div class="capability-card">
                <div class="capability-header">
                    <span class="capability-icon">üìß</span>
                    <span class="capability-status available">Available</span>
                </div>
                <h3>Gmail</h3>
                <p>Read and send emails, manage inbox</p>
                <button class="btn btn-primary" onclick="connectIntegration('gmail')">Connect</button>
            </div>

            <div class="capability-card">
                <div class="capability-header">
                    <span class="capability-icon">üìÖ</span>
                    <span class="capability-status available">Available</span>
                </div>
                <h3>Google Calendar</h3>
                <p>View and manage calendar events</p>
                <button class="btn btn-primary" onclick="connectIntegration('google-calendar')">Connect</button>
            </div>

            <div class="capability-card">
                <div class="capability-header">
                    <span class="capability-icon">üó∫Ô∏è</span>
                    <span class="capability-status available">Available</span>
                </div>
                <h3>Google Maps</h3>
                <p>Geocoding, directions, places search</p>
                <button class="btn btn-primary" onclick="connectIntegration('google-maps')">Connect</button>
            </div>

            <div class="capability-card">
                <div class="capability-header">
                    <span class="capability-icon">üìÅ</span>
                    <span class="capability-status available">Available</span>
                </div>
                <h3>Google Drive</h3>
                <p>Access and manage files</p>
                <button class="btn btn-primary" onclick="connectIntegration('google-drive')">Connect</button>
            </div>

            <div class="capability-card">
                <div class="capability-header">
                    <span class="capability-icon">üìä</span>
                    <span class="capability-status available">Available</span>
                </div>
                <h3>Google Sheets</h3>
                <p>Read and write spreadsheet data</p>
                <button class="btn btn-primary" onclick="connectIntegration('google-sheets')">Connect</button>
            </div>

            <div class="capability-card">
                <div class="capability-header">
                    <span class="capability-icon">üì¨</span>
                    <span class="capability-status available">Available</span>
                </div>
                <h3>Outlook</h3>
                <p>Microsoft email integration</p>
                <button class="btn btn-primary" onclick="connectIntegration('microsoft-outlook')">Connect</button>
            </div>
        </div>

        <!-- Connected Integrations -->
        <div class="card">
            <h2>üîó Connected Integrations</h2>
            <div id="connected-integrations">
                <p style="text-align: center; color: var(--text-secondary); padding: 2rem;">
                    No integrations connected yet. Connect services above to get started.
                </p>
            </div>
        </div>

        <!-- MCP Bridge Connection for Local Apps -->
        <div class="card">
            <h2>üíª Local App Connection (Claude Desktop, ChatGPT Desktop)</h2>
            <p style="margin-bottom: 1rem; color: var(--text-secondary);">
                Connect your local AI apps (Claude Desktop, ChatGPT Desktop) to MCP Bridge to use integrations from those apps.
            </p>

            <div style="background: #f9fafb; padding: 1.5rem; border-radius: 8px; border-left: 4px solid var(--tdc-blue); margin-bottom: 1rem;">
                <h3 style="margin-bottom: 0.75rem;">Claude Desktop Setup:</h3>
                <pre style="background: #1a1a1a; color: #f0f0f0; padding: 1rem; border-radius: 6px; overflow-x: auto; font-size: 0.85rem;">{
  "mcpServers": {
    "mcp-bridge": {
      "command": "node",
      "args": ["C:/Users/claus/mcp-bridge/mcp-server/bridge-connector.js"],
      "env": {
        "MCP_BRIDGE_URL": "http://localhost:3000"
      }
    }
  }
}</pre>
                <p style="margin-top: 0.75rem; font-size: 0.9rem; color: var(--text-secondary);">
                    Add this to: <code>%APPDATA%\Claude\claude_desktop_config.json</code>
                </p>
            </div>

            <div style="background: #f9fafb; padding: 1.5rem; border-radius: 8px; border-left: 4px solid var(--success);">
                <h3 style="margin-bottom: 0.75rem;">ChatGPT Desktop Setup:</h3>
                <p style="font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 0.5rem;">
                    Similar configuration for ChatGPT Desktop MCP support (when available)
                </p>
                <button class="btn btn-primary" onclick="copyClaudeConfig()">üìã Copy Claude Config</button>
                <button class="btn btn-primary" style="margin-left: 0.5rem;" onclick="testMCPConnection()">üß™ Test Connection</button>
            </div>
        </div>
    </div>

    <script>
        const API_BASE = window.location.hostname === 'localhost' ? 'http://localhost:3000' : window.location.origin;

        async function loadCapabilities() {
            try {
                const response = await fetch(`${API_BASE}/api/integrations/capabilities`);
                const data = await response.json();
                // Update UI with capabilities
            } catch (error) {
                console.error('Failed to load capabilities:', error);
            }
        }

        async function loadConnectedIntegrations() {
            try {
                const response = await fetch(`${API_BASE}/api/integrations`);
                const data = await response.json();

                const container = document.getElementById('connected-integrations');

                if (data.integrations && data.integrations.length > 0) {
                    container.innerHTML = data.integrations.map(int => `
                        <div class="integration-item">
                            <div class="integration-info">
                                <div class="integration-name">
                                    ${int.name}
                                    <span class="badge ${int.enabled ? 'enabled' : 'disabled'}">
                                        ${int.enabled ? 'Enabled' : 'Disabled'}
                                    </span>
                                </div>
                                <div class="integration-meta">
                                    Type: ${int.type} ‚Ä¢ Created: ${new Date(int.createdAt).toLocaleDateString()}
                                </div>
                            </div>
                            <div class="integration-actions">
                                <button class="btn btn-primary" onclick="testIntegration('${int.id}')">üß™ Test</button>
                                <button class="btn btn-danger" onclick="deleteIntegration('${int.id}')">üóëÔ∏è Delete</button>
                            </div>
                        </div>
                    `).join('');
                } else {
                    container.innerHTML = '<p style="text-align: center; color: var(--text-secondary); padding: 2rem;">No integrations connected yet.</p>';
                }
            } catch (error) {
                console.error('Failed to load integrations:', error);
            }
        }

        function connectIntegration(type) {
            alert(`Connecting to ${type}...\nOAuth flow will be implemented in the full version.`);
            // TODO: Implement OAuth flow
        }

        async function testIntegration(id) {
            alert('Testing integration: ' + id);
            // TODO: Call test endpoint
        }

        async function deleteIntegration(id) {
            if (!confirm('Are you sure you want to delete this integration?')) return;

            try {
                await fetch(`${API_BASE}/api/integrations/${id}`, {
                    method: 'DELETE',
                });

                await loadConnectedIntegrations();
            } catch (error) {
                alert('Failed to delete integration');
            }
        }

        function copyClaudeConfig() {
            const config = `{
  "mcpServers": {
    "mcp-bridge": {
      "command": "node",
      "args": ["C:/Users/claus/mcp-bridge/mcp-server/bridge-connector.js"],
      "env": {
        "MCP_BRIDGE_URL": "http://localhost:3000"
      }
    }
  }
}`;

            navigator.clipboard.writeText(config);
            alert('‚úÖ Configuration copied to clipboard!\n\nPaste into:\n%APPDATA%\\Claude\\claude_desktop_config.json');
        }

        async function testMCPConnection() {
            try {
                const response = await fetch(`${API_BASE}/health`);
                const data = await response.json();

                if (data.status === 'healthy') {
                    alert('‚úÖ MCP Bridge is running and healthy!\n\nRestart Claude Desktop to connect.');
                } else {
                    alert('‚ö†Ô∏è MCP Bridge is running but some providers are unhealthy.');
                }
            } catch (error) {
                alert('‚ùå Cannot connect to MCP Bridge.\n\nMake sure the server is running:\nnpm run dev');
            }
        }

        // Load on page load
        loadCapabilities();
        loadConnectedIntegrations();
    </script>
</body>
</html>
